<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>แบบฟอร์มบันทึกข้อมูล</title>
</head>
<body>
  <div>
    <h2>แบบฟอร์มบันทึกข้อมูล</h2>
    <form id="dataForm">
      <label>ชื่อฝ่ายขาย:</label>
      <input type="text" name="salesName" required><br>
      
      <label>จังหวัด:</label>
      <input type="text" name="region" required><br>
      
      <label>ชื่อร้านค้า:</label>
      <input type="text" name="storeName" required><br>
      
      <label>เบอร์โทร:</label>
      <input type="text" name="phone" required><br>
      
      <label>ชื่อผู้ติดต่อ:</label>
      <input type="text" name="contactName" required><br>
      
      <label>ตำแหน่งผู้ติดต่อ:</label>
      <input type="text" name="contactPosition" required><br>
      
      <label>ตำแหน่งปัจจุบัน:</label>
      <input type="text" name="location" id="location" readonly>
      <button type="button" onclick="shareLocation()">แชร์ตำแหน่ง</button><br>
      
      <button type="submit">บันทึกข้อมูล</button>
    </form>
  </div>

  <script>
    const scriptURL = 'https://script.google.com/macros/s/AKfycbyI2ZWj_u4LtyRRzhADIl-ltvK72IRCBVTJLIzzARfgTTXPk-q1H_BjbQ_c9rPa5ICj/exec'; // ใส่ URL จาก Google Apps Script

    async function submitForm(event) {
      event.preventDefault();

      const formData = new FormData(event.target);
      const data = Object.fromEntries(formData);

      try {
        const response = await fetch(scriptURL, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data),
        });

        if (response.ok) {
          alert('บันทึกข้อมูลสำเร็จ');
        } else {
          alert('เกิดข้อผิดพลาดในการบันทึกข้อมูล');
        }
      } catch (error) {
        alert('ส่งข้อมูลไม่สำเร็จ: ' + error.message);
      }
    }

    function shareLocation() {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(
          (position) => {
            const { latitude, longitude } = position.coords;
            document.getElementById('location').value = `Latitude: ${latitude}, Longitude: ${longitude}`;
          },
          () => alert('ไม่สามารถดึงตำแหน่งได้')
        );
      } else {
        alert('เบราว์เซอร์ของคุณไม่รองรับ Geolocation');
      }
    }

    document.getElementById('dataForm').addEventListener('submit', submitForm);
  </script>
</body>
</html>
